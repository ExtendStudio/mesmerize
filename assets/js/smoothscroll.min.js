var currentPageURL=document.location.toString(),isAnchor=!1;location.hash&&(isAnchor=!0,window.scrollTo(0,0)),function(e){function t(e){return!e||"_self"==e}function n(e){if(!e)return!1;var t=e.indexOf("#");if(t>-1){if(0===t)return e.replace("#","");var n=e.substring(t+1),r="";e.indexOf("?")>-1&&(r=e.substring(e.indexOf("?")));var i=/(https?|file):\/\//,a=window.location.pathname,o=e.replace(r,"").replace("#"+n,"").replace(i,"");if(e.match(i)?a=window.location.host+a:o=a.substring(0,a.lastIndexOf("/"))+"/"+o,a==o||a==o+"/")return n}return!1}function r(e){setTimeout(function(){e=e?"#"+e:"",history&&history.replaceState&&history.replaceState({},"",e)},100)}function i(e,t){if(!m)try{if(m=!0,e){var n;t&&(n=t.parent().parentsUntil("body").filter(function(){if("fixed"==jQuery(this).css("position")&&!jQuery(this).is(".mobile-overlay"))return jQuery(this)}).eq(0));var r=0;if(n&&n.length){n.attr("class"),jQuery('div[class*="main-menu"]');n.outerHeight()===window.innerHeight&&n.is(".full-sidebar")||(r=n.outerHeight()+n.position().top)}var i=e.offset().top-r;i<0&&(i=0),i>jQuery("[data-cp-shrink=initial]").height()&&(i-=jQuery("[data-cp-shrink=shrinked]").height());var a=Math.max(.5,i/jQuery("body").height());return jQuery("html, body").animate({scrollTop:i},g*a,p,function(){m=!1,jQuery(window).trigger("scroll"),jQuery(document).trigger("scroll")}),!0}}catch(e){}}function a(e,n){if(t(n.attr("target"))){var r=!!n.data("onepage-section")&&n.data("onepage-section");r&&r.length&&e.preventDefault(),i(r,n)&&e&&e.preventDefault()}}function o(e){var t;do{t=!1;for(var n=0;n<e.length-1;n++){var r=e[n],i=e[n+1];if(r.offset().top>i.offset().top){var a=e[n];e[n]=e[n+1],e[n+1]=a,t=!0}}}while(t)}function u(){f=[],(h=jQuery("a").filter(function(){var t=jQuery(this),r=t.attr("href"),i=(t.attr("target"),n(r));if(i&&"wp-toolbar"!==i)try{var a=jQuery("#"+i);if(a.length>0){if(t.data("onepage-section",a),"LI"==t.parent()[0].tagName){var o=a.data("onepage-anchor")||e("");o=o.add(t),a.data("onepage-anchor",o)}return f.push(a),!0}}catch(e){}return!1})).each(function(){if(!jQuery(this).closest(".fm2_mobile_jq_menu").length&&jQuery(this).is(":visible"))if(jQuery(this).parent().is("li.menu-item")){var e=this;jQuery(this).unbind("click.onepage"),jQuery(this).attr("data-smoothscroll","true"),jQuery(this).parent().unbind("click.onepage").bind("click.onepage",function(t){jQuery(t.target).parent().is(t.currentTarget)&&(t.preventDefault(),t.stopPropagation(),a(t,jQuery(e)))})}else jQuery(this).unbind("click.onepage").bind("click.onepage",function(e){a(e,jQuery(this))})});try{o(f)}catch(e){}}function c(){var t=jQuery(window),n=t.scrollTop()+.5*window.innerHeight,i=[];f||u();for(var a=0;a<f.length;a++)f[a].offset().top<n&&i.push(f[a]);var o=f[f.length-1];t.scrollTop()+t.height()+50>=jQuery(document).height()&&i.push(o);var c=(i=i[i.length-1])&&i.length?i[0].id:"";if(r(c),0===c.length&&h&&(h.parent().andSelf().removeClass("current_page_item current-menu-item"),loc=(window.location+"").split("#")[0].replace(/\/$/,""),h.closest("ul").find('[href$="'+loc+'"]').parent().andSelf().addClass("current-menu-item"),loc.length||h.closest("ul").find('[href$="'+window.location+'"]').parent().andSelf().addClass("current-menu-item")),s!==c&&c.length){s=c;try{h.filter(".current_page_item, .current-menu-item").each(function(){jQuery(this).parent().andSelf().removeClass("current_page_item current-menu-item")}),h.closest("ul").find(".current_page_item, .current-menu-item").removeClass("current_page_item current-menu-item"),i.data("onepage-anchor").each(function(){e(this).parent().andSelf().addClass("current-menu-item")})}catch(e){}}}function l(){u()}if(!window.useManagedSmoothScroll){var s,h,f,d,g=1500,p="easeInOutQuart",m=!1,y="ontouchstart"in document.documentElement;y||jQuery(window).scroll(function(){clearTimeout(d),d=setTimeout(c,20)});var j;if(jQuery(window).bind("resize orientationchange",function(){clearTimeout(j),j=setTimeout(l,100)}),u(),(y="ontouchstart"in document.documentElement)||c(),isAnchor)if(jQuery.find('a[href^="'+currentPageURL+'"]').length>0)jQuery(jQuery.find('a[href="'+currentPageURL+'"]')).trigger("click");else{var v=n(currentPageURL);v.length&&jQuery(jQuery.find('a[href*="#'+v+'"]')).trigger("click")}else jQuery('a[href*="#"]').each(function(e,t){var n=t.href.split("#"),r=n[n.length-1];n.length>=2&&r.length&&jQuery(this).parent().andSelf().removeClass("current_page_item current-menu-item")});window.wp&&window.wp.customize&&e(".dropdown-menu").parent("div").parent().on("DOMNodeInserted DOMNodeRemoved",function(e){u(),c()}),window.scrollToSection=i,window.smoothScrollGetAnchors=u}}(jQuery);